<div class="dnn-mdt-panel dnn-mdt-bgColorDnnBlue">
    <div class="dnn-mdt-checkbox">
        <input type="checkbox" id="dnn-mdt-enableCheckbox">
        <label for="dnn-mdt-enableCheckbox" class="dnn-mdt-copy dnn-mdt-colorWhite">Enable DNN Dev Tools</label>
    </div>
</div>

<div class="dnn-mdt-panel dnn-mdt-bgColorWhite dnn-mdt-marginTop2">
    <h2 class="dnn-mdt-headline">Mail Catch</h2>
    <div class="dnn-mdt-checkbox">
        <input type="checkbox" id="dnn-mdt-enableMailCatchCheckbox">
        <label for="dnn-mdt-enableMailCatchCheckbox" class="dnn-mdt-copy">Enable mail catch</label>
    </div>
    <div class="dnn-mdt-marginTop2">
        <button type="button" id="dnn-mdt-sendMailButton">Send test mail</button>
    </div>
</div>

<div class="dnn-mdt-panel dnn-mdt-bgColorWhite dnn-mdt-marginTop2">
    <h2 class="dnn-mdt-headline">Event catch</h2>
    <div class="dnn-mdt-checkbox">
        <input type="checkbox" id="dnn-mdt-enableEventCatchCheckbox">
        <label for="dnn-mdt-enableEventCatchCheckbox" class="dnn-mdt-copy">Enable event catch</label>
    </div>
</div>

<div class="dnn-mdt-panel dnn-mdt-bgColorWhite dnn-mdt-marginTop2">
    <h2 class="dnn-mdt-headline">Logging</h2>
    <div class="dnn-mdt-checkbox">
        <input type="checkbox" id="dnn-mdt-enableLoggingCheckbox">
        <label for="dnn-mdt-enableLoggingCheckbox" class="dnn-mdt-copy">Enable logging</label>
    </div>
    <div class="dnn-mdt-marginTop2">
        <label for="dnn-mdt-logLevelSelect" class="dnn-mdt-copy dnn-mdt-displayBlock">Select log level</label>
        <select name="" id="dnn-mdt-logLevelSelect" class="dnn-mdt-select dnn-mdt-marginTop1">
            <option value="ALL">all</option>
            <option value="DEBUG">debug</option>
            <option value="INFO">info</option>
            <option value="WARN">warning</option>
            <option value="ERROR">error</option>
            <option value="FATAL">fatal</option>
        </select>
    </div>
</div>

<script>
    (function () {
        var enableCheckbox = document.getElementById('dnn-mdt-enableCheckbox'),
            enableMailCatchCheckbox = document.getElementById('dnn-mdt-enableMailCatchCheckbox'),
            enableEventCatchCheckbox = document.getElementById('dnn-mdt-enableEventCatchCheckbox'),
            enableLoggingCheckbox = document.getElementById('dnn-mdt-enableLoggingCheckbox'),
            logLevelSelect = document.getElementById('dnn-mdt-logLevelSelect'),
            sendMailButton = document.getElementById('dnn-mdt-sendMailButton');

        // set current status
        enableCheckbox.checked = window.weweave.dnnDevTools.enable;
        enableMailCatchCheckbox.checked = window.weweave.dnnDevTools.enableMailCatch;
        enableEventCatchCheckbox.checked = window.weweave.dnnDevTools.enableEventCatch;
        enableLoggingCheckbox.checked = window.weweave.dnnDevTools.logMessageLevel !== 'OFF';

        enableCheckbox.addEventListener('change', function (event) {
            setStatus(enableCheckbox.checked);
        }, false);

        enableMailCatchCheckbox.addEventListener('change', function (event) {
            setMailCatchStatus(enableMailCatchCheckbox.checked);
        }, false);

        sendMailButton.addEventListener('click', function () {
            sendMail();
        }, false);

        enableEventCatchCheckbox.addEventListener('click', function () {
            setEventCatchStatus(enableEventCatchCheckbox.checked);
        }, false);



        enableLoggingCheckbox.addEventListener('click', function () {
            setLoggingStatus(enableLoggingCheckbox.checked);
        }, false);



        logLevelSelect.addEventListener('change', function () {
            setLogLevel(logLevelSelect.value);
        });

        function setStatus(isEnabled) {
            dnnMdt.ajax('PUT', window.weweave.dnnDevTools.baseUrl + 'api/config/enable?status=' + isEnabled).then(
                function (response) {
                    window.location.reload(false);
                }, function (error) {
                    // TODO show error
                }
            );
        }

        function setMailCatchStatus(isEnabled) {
            dnnMdt.ajax('PUT', window.weweave.dnnDevTools.baseUrl + 'api/config/enableMailCatch?status=' + isEnabled).then(
                function (response) {
                    console.log(response);
                }, function (error) {
                    // TODO show error
                }
            );
        }

        function setEventCatchStatus(isEnabled) {
            dnnMdt.ajax('PUT', window.weweave.dnnDevTools.baseUrl + 'api/config/enableDnnEventCatch?status=' + isEnabled).then(
                function (response) {
                    console.log(response);
                }, function (error) {
                    // TODO show error
                }
            );
        }

        function setLoggingStatus(isEnabled) {
            if (isEnabled) {
                setLogLevel(logLevelSelect.value);
            } else {
                setLogLevel('OFF');
            }
        }

        function sendMail() {
            dnnMdt.ajax('POST', window.weweave.dnnDevTools.baseUrl + 'api/mail/sendMail').then(
                function (response) {
                    console.log(response);
                }, function (error) {
                    // TODO show error
                }
            );
        }

        function setLogLevel(level) {
            dnnMdt.ajax('PUT', window.weweave.dnnDevTools.baseUrl + 'api/config/setLogMessageLevel?level=' + level).then(
                function (response) {
                    console.log(response);
                }, function (error) {
                    // TODO show error
                }
            );
        }
    }());
</script>